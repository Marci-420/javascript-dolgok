<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.8.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.8.1/firebase-firestore-compat.js"></script>
    <title>AdatBázis</title>

    <script>

        const firebaseConfig = {
        apiKey: "AIzaSyAKfeeSAmN-_FuvGiu5pyNfGCj1AYyVyXg",
        authDomain: "vendegkonyv-9e363.firebaseapp.com",
        projectId: "vendegkonyv-9e363",
        storageBucket: "vendegkonyv-9e363.appspot.com",
        messagingSenderId: "168753603731",
        appId: "1:168753603731:web:567e01c81dcfd837499966"
        };

        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore(app);

        
        lista =[]
        function print(){
           
            const name = document.getElementById("name").value
            const message = document.getElementById("message").value
            console.log(name)
            
            db.collection("vendegkonyv").add({
                nev: name,
                uzenet: message
            })

            .then((docRef) => {
                console.log(docRef.id);
            })
            

            .catch((error) => {
                console.error(error);
            })
            
            db.collection("vendegkonyv").onSnapshot((querySanpshot) => {
                const documents = querySanpshot.docs;
                for(let i = 0; i< documents.length; i++){
                    console.log(documents[i].data())
                }
            })
            
            const obj = { name, message }
            lista.push(obj)
            table(obj);    
        }

        function nullaz() {

            document.getElementById("name").value = "";
            document.getElementById("message").value = "";
            
        }



        function table(obj) {
        const tableBody = document.getElementById("tabla");
        

        const tableRow = document.createElement("tr");
        tableBody.appendChild(tableRow);

        const titleCell = document.createElement("td");
        titleCell.innerHTML = obj.name;
        tableRow.appendChild(titleCell);

        const authorCell = document.createElement("td");
        authorCell.innerHTML = obj.message;
        tableRow.appendChild(authorCell);

        const dateCell = document.createElement("td");
        dateCell.innerHTML = obj.date;
        tableRow.appendChild(authorCell);

    }
    </script>

    <style>
        button{
            margin-top: 30px;
        }
        body{
            margin: 30px;
        }
        h1{
            margin-bottom: 10px;
        }
    </style>

</head>
<body>
   
    
    <div class="container">
        <form action=" ">  
            <div>
                <h1> Vendégkönyv</h1>

                <h4> Név</h4>  
                <input type="text" class="form-control" id="name">  
                <h4> Üzenet</h4>  
                <input type="textarea" class="form-control" id="message" placeholder="Ide írd az üzeneted!"> 
                 
                <button  type="button" class="btn btn-primary" onclick="print(), nullaz()">Üzenet elküldése</button>
                
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">Név:</th>
                            <th scope="col">Bejegyzés dátuma:</th>
                            <th scope="col">Üzenet:</th>
                        </tr>
                    </thead>
                    <tbody id="tabla">

                    </tbody>
                </table>

            </div>
        </form>

    </div>
    
</body>
</html>